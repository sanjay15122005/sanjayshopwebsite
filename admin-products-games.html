<!DOCTYPE html>
<html>
<head>
    <title>CK Gamers Zone - Product Admin</title>
</head>
<body>

<h1>Game Products</h1>

<div>
    <h3>Add Game Product</h3>
    <input id="name" type="text" placeholder="Product Name"><br>
    <input id="price" type="number" placeholder="Price"><br>
    <input id="image" type="text" placeholder="Image URL"><br>

    <button onclick="addProduct()">Add Game Product</button>
</div>

<h2>All Game Products</h2>
<div id="productList"></div>

<script>
async function addProduct() {
  const name = document.getElementById("name").value;
  const price = document.getElementById("price").value;
  const image = document.getElementById("image").value;

  const token = localStorage.getItem("token");

  if (!token) {
    alert("Please login again");
    window.location.href = "admin-login.html";
    return;
  }

  const res = await fetch("https://sanjayshop-backend.onrender.com/add-product", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      name,
      price,
      image,
      category: "game"
    })
  });

  const data = await res.json();

  if (data.success) {
    alert("Product added");
    loadProducts();
  } else {
    alert(data.message);
  }
}

async function loadProducts() {
  const token = localStorage.getItem("token");

  const res = await fetch("https://sanjayshop-backend.onrender.com/products", {
    headers: {
      "Authorization": token
    }
  });

  const data = await res.json();

  if (!Array.isArray(data)) {
    console.error(data);
    return;
  }

  const games = data.filter(p => p.category === "game");

  const list = document.getElementById("products");
  list.innerHTML = "";

  games.forEach(p => {
    list.innerHTML += `
      <div style="border:1px solid #ccc; padding:10px; margin:10px;">
        <h3>${p.name}</h3>
        <p>â‚¹${p.price}</p>
        <img src="${p.image}" width="120">
      </div>
    `;
  });
}

loadProducts();


</script>

</body>
</html>
